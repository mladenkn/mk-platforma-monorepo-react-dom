generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Post {
  id         Int    @id @default(autoincrement())
  title      String
  content    String
  contact    String
  locationId Int?
  userId     Int
  authorId   Int

  expert_firstName String?
  expert_lastName  String?

  location   Location?  @relation(fields: [locationId], references: [id])
  images     Image[]
  comments   Comment[]
  categories Category[]
  author     User       @relation(fields: [authorId], references: [id])
}

enum CategoryLabel {
  job
  accommodation
  personEndorsement
  sellable
  gathering
  gathering_spirituality
  gathering_work
  gathering_hangout
}

model Category {
  id       Int           @id @default(autoincrement())
  label    CategoryLabel @unique
  parentId Int?
  posts    Post[]

  parent   Category?  @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children Category[] @relation("CategoryHierarchy")
}

model Location {
  id        Int     @id @default(autoincrement())
  googleId  String
  latitude  Decimal
  longitude Decimal

  post Post[]
}

model Image {
  id           Int    @id @default(autoincrement())
  cloudinaryId String
  postId       Int

  post Post @relation(fields: [postId], references: [id])
}

model Comment {
  id       Int    @id @default(autoincrement())
  content  String
  authorId Int
  postId   Int

  post   Post @relation(fields: [postId], references: [id])
  author User @relation(fields: [authorId], references: [id])
}

model User {
  id          Int    @id @default(autoincrement())
  name        String
  avatarStyle Json

  comments Comment[]
  posts    Post[]
}
